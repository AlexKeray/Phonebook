USE PHONEBOOK
GO

DECLARE @VAR_CITY_NAME NCHAR(64);
DECLARE @VAR_AREA NCHAR(64);

SET @VAR_CITY_NAME = N'Варна'
SET @VAR_AREA = N'Варна'

IF EXISTS (
SELECT *
FROM CITIES
WHERE CITY_NAME = @VAR_CITY_NAME
	AND AREA = @VAR_AREA
)
	PRINT N'City names combination is not unique'

BEGIN TRY
BEGIN TRANSACTION

INSERT INTO CITIES (
	[UPDATE_COUNTER],
	[CITY_NAME],
	[AREA]
)
	VALUES(
		0, 
		@VAR_CITY_NAME, 
		@VAR_AREA
	)

	COMMIT TRANSACTION
END TRY
BEGIN CATCH
	PRINT ERROR_MESSAGE()
	ROLLBACK TRANSACTION
END CATCH
GO